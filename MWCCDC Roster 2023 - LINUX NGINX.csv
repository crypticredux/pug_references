,NGINX,
,Control Buffer Overflow attacks,
,,
,,sudo nano /usr/local/nginx/conf/nginx.conf
,,
,,## Start: Size Limits & Buffer Overflows ##
,,client_body_buffer_size 1K;
,,client_header_buffer_size 1k;
,,client_max_body_size 1k;
,,large_client_header_buffers 2 1k;
,,## END: Size Limits & Buffer Overflows ##
,,
,,## Start: Timeouts ##
,,client_body_timeout 10;
,,client_header_timeout 10;
,,keepalive_timeout 5 5;
,,send_timeout 10;
,,## End: Timeouts ##
,Edit php.ini,
,,sudo nano /etc/php.ini
,,
,,# Disallow dangerous functions
,,"disable_functions = phpinfo, system, mail, exec"
,,
,,## Try to limit resources ##
,,
,,"# Maximum execution time of each script, in seconds"
,,max_execution_time = 30
,,
,,# Maximum amount of time each script may spend parsing request data
,,max_input_time = 60
,,
,,# Maximum amount of memory a script may consume (8MB)
,,memory_limit = 8M
,,
,,# Maximum size of POST data that PHP will accept.
,,post_max_size = 8M
,,
,,# Whether to allow HTTP file uploads.
,,file_uploads = Off
,,
,,# Maximum allowed size for uploaded files.
,,upload_max_filesize = 2M
,,
,,# Do not expose PHP error messages to external users
,,display_errors = Off
,,
,,# Turn on safe mode
,,safe_mode = On
,,
,,# Only allow access to executables in isolated directory
,,safe_mode_exec_dir = php-required-executables-path
,,
,,# Limit external access to PHP environment
,,safe_mode_allowed_env_vars = PHP_
,,
,,# Restrict PHP information leakage
,,expose_php = Off
,,
,,# Log all errors
,,log_errors = On
,,
,,# Do not register globals for input data
,,register_globals = Off
,,
,,# Minimize allowable PHP post size
,,post_max_size = 1K
,,
,,# Ensure PHP redirects appropriately
,,cgi.force_redirect = 0
,,
,,# Disallow uploading unless necessary
,,file_uploads = Off
,,
,,# Enable SQL safe mode
,,sql.safe_mode = On
,,
,,# Avoid Opening remote files
,,allow_url_fopen = Off
,,
,Limit connections per IP,
,,/sbin/iptables -A INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --set
,,/sbin/iptables -A INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --update --seconds 60 --hitcount 15 -j DROP
,,"/sbin/iptables -A OUTPUT -o eth0 -m owner --uid-owner vivek -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT"
,,service iptables save
,,
,"Avoid clickjacking, content sniffing, enable XSS filter",
,,sudo nano ./nginx.conf
,,
,,add_header X-Frame-Options SAMEORIGIN;
,,add_header X-Content-Type-Options nosniff;
,,"add_header X-XSS-Protection ""1; mode=block"";"